<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<head>
    <meta charset="UTF-8">
    <title>게시판</title>
</head>
<body>
    <h1>게시판</h1>
    <table>
        <thead>
            <tr>
                <th>게시물 제목</th>
                <th>작성자</th>
				<th>조회수</th>
                <th>작성일</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="post : ${posts}">
				<td><a th:href="@{/board/{categoryID}/{postID}(postID=${post.postID})}" th:text="${post.postName}"></a></td>
				<td th:text="${post.authorName != null ? post.authorName : 'Unknown'}"></td>
				<td th:text="${post.visitCnt}"></td>
				<td th:text="${post.writeDate}"></td>
            </tr>
        </tbody>
    </table>
	<!-- 페이징처리 시작 -->
	    <div th:if="${!posts.isEmpty()}">
	        <ul class="pagination justify-content-center">
	            <li class="page-item" th:classappend="${!posts.hasPrevious} ? 'disabled'">
	                <a class="page-link"
	                    th:href="@{|?page=${posts.number-1}|}">
	                    <span>이전</span>
	                </a>
	            </li>
	            <li th:each="page: ${#numbers.sequence(0, posts.totalPages-1)}"
	            	th:if="${page >= posts.number-2 and page <= posts.number+2}"
	                th:classappend="${page == posts.number} ? 'active'" 
	                class="page-item">
	                <a th:text="${page+1}" class="page-link" th:href="@{|?page=${page}|}"></a>
	            </li>
	            <li class="page-item" th:classappend="${!posts.hasNext} ? 'disabled'">
	                <a class="page-link" th:href="@{|?page=${posts.number+1}|}">
	                    <span>다음</span>
	                </a>
	            </li>
	        </ul>
	    </div>
	    <!-- 페이징처리 끝 -->
		<!-- 검색 기능 -->
		<div class="form-group row justify-content-center">			
			<div class="w100" style="padding-right:10px">				
				<select class="form-control form-control-sm" name="searchType" id="searchType">					
					<option value="postName">제목</option>					
					<option value="content">본문</option>					
					<option value="authorName">작성자</option>				
				</select>			
			</div>			
			<div class="w300" style="padding-right:10px">				
				<input type="text" class="form-control form-control-sm" name="keyword" id="keyword">			
			</div>			
			<div>				
				<button class="btn btn-sm btn-primary" name="btnSearch" id="btnSearch">검색</button>			
			</div>		
		</div>
		
		
	<div class="btn_wrap text-right">
					<a th:href="@{/board/register/new}" class="btn btn-primary waves-effect waves-light">글쓰기</a>
	</div>
	
	<script>   		
		$(document).on('click', '#btnSearch', function(e){		
			e.preventDefault();
	        var url = "/board/search"; 
	        url = url + "?searchType=" + $('#searchType').val();
	        url = url + "&keyword=" + $('#keyword').val();
	        location.href = url;
	        console.log(url);
		});	
		
	</script>
</body>
</html>