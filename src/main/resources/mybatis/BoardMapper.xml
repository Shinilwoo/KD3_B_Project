<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.demo.board.BoardMapper">

	<resultMap id="CategoryResultMap" type="com.example.demo.category.Category">
	    <id property="categoryID" column="category_categoryID"/>
	    <result property="categoryName" column="categoryName"/>
	</resultMap>
	<resultMap id="BoardResultMap" type="com.example.demo.board.Board">
        <id property="postID" column="postID"/>
        <result property="authorName" column="authorName"/>
        <result property="authorLink" column="authorLink"/>
        <result property="postName" column="postName"/>
        <result property="content" column="content"/>
        <result property="visitCnt" column="visitCnt"/>
        <result property="writeDate" column="writeDate"/>
        <result property="endDate" column="endDate"/>
        <result property="eventStart" column="eventStart"/>
        <result property="eventEnd" column="eventEnd"/>
        
        <association property="user_userID" javaType="com.example.demo.user.User">
        <result property="userID" column="user_userID"/>
	        <!-- 추가적인 사용자 정보 컬럼들에 대한 매핑 -->
	    </association>
	    <association property="category_categoryID" javaType="com.example.demo.category.Category">
	        <result property="categoryID" column="category_categoryID"/>
	        <!-- 추가적인 카테고리 정보 컬럼들에 대한 매핑 -->
	        <result property="categoryName" column="categoryName"/>
	    </association>
	    
    </resultMap>

    <select id="findAll" resultMap="BoardResultMap">
        SELECT b.*, c.categoryName
    	FROM board b
    	JOIN category c ON b.category_categoryID = c.categoryID
    </select>

   <select id="findByCategoryId" resultMap="BoardResultMap" parameterType="int">
        SELECT b.postName, c.categoryName, b.authorName, b.content
	    FROM board b
	    JOIN user u ON u.userID = b.user_userID
	    JOIN category c ON b.category_categoryID = c.categoryID
	    WHERE b.category_categoryID = #{categoryID}
    </select>

    <select id="findById" resultMap="BoardResultMap" parameterType="int">
        SELECT b.*, u.userID, c.categoryName
		FROM board b
		JOIN user u ON u.userID = b.user_userID
		JOIN category c ON c.categoryID = b.category_categoryID
		WHERE b.postID = #{postID}
    </select>


</mapper>